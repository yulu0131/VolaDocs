# 基于有限差分法的局域波动率模型定价
## 简介

采用一种高效、精确的计算方法，基于给定市场期权价格重构局部波动率曲面。局部波动率取决与时间和标的资产价格的值， 函数表达形式为 $\sigma(S, t)$。采用广义Black-Scholes方程和有限差分法对广义Black-Scholes方程进行了数值求解，通过最小化成本函数对理论期权价格和市场期权价格进行最佳拟合，表现形式为理论期权价格与市场期权价格之间差异的平方，并将未知波动率的点置于到期日中间从而实现高效计算 （Kwak et al., 2022）。通过实证分析，用该方法重构的局部波动率曲面简单高效。

## 拟合方法

采用广义BS方程从市场价格中重构局部波动率函数 $\sigma(S, t)$，如下：

$$
\frac{\partial \mu(S, \tau)}{\partial \tau} = \frac{1}{2} [\sigma(S, \tau)S]^2\frac{\partial^2 \mu(S, \tau)}{\partial S^2} + rS\frac{\partial \mu (S, \tau)}{\partial S} - r\mu (S, \tau)
$$
   对于 $(S, \tau) \in \Omega \times （0, T ]$, 初始条件为$\mu(S, 0)$，其中$\tau = T - t$，$\mu(S, t)$ 为期权价值。

采用隐式差分法离散上述方程

通过拟合得出的局域波动率模型$\sigma(S,t)$，对场外期权进行定价

## 提升优化

为了实现该方法的应用性，进一步提升计算效率。对输入数据也进行了处理，重构的波动率曲面能够适用于看涨和看跌期权。

采用平价公式（Put-Call Parity）计算标的市场价格，重构的局部波动率曲面能够同时适用于看涨和看跌期权。
$$
S = C-P+PV(K)
$$

- $S$ 为挂钩标的资产当前市场价值的现货价格
- $PV(K)$ 为行权价的现值
- $C$为看涨期权的市场价
- $P$为看跌期权的市场价

1. 采用德劳内三角剖分（Delaunay Triangulation）进行二维线性插值，该方法自适应性强
2. 为了提升计算效率，采用BFGS（Broyden–Fletcher–Goldfarb–Shanno）方法，结合带有梯度投影（gradient projection）发的回溯线搜索（backtracking line search）处理非线性的最小化成本函数，边界条件约束为（0, 1）


## 实证分析

原文献仅对看涨期权进行了实证检验，重构的局部波动率曲面仅适用于看涨期权。首先，采用原文的数据重构局部波动率曲面并与市场价格进行对比，复现原文献的结果。



### References
